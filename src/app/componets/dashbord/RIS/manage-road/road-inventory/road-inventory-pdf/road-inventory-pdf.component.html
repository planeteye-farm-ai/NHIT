<app-page-header
  title="Inventory PDF Report"
  title1="Inventory PDF Report"
  activeTitle="Inventory PDF Report"
></app-page-header>

<div class="row">
  <div class="col-xl-12">
    <div class="card">
      <div class="card-body">
        <!-- Action Buttons -->
        <div class="d-flex justify-content-between mb-4">
          <button
            type="button"
            class="btn btn-secondary"
            [routerLink]="[
              '/ris/road-manage/road-inventory',
              inventoryData?.geometry_data_id
            ]"
          >
            <i class="ri-arrow-left-line me-1"></i>Back to List
          </button>
          <button
            type="button"
            class="btn btn-primary"
            (click)="generatePDF()"
            [disabled]="!inventoryData"
          >
            <i class="ri-file-pdf-line me-1"></i>Download PDF
          </button>
        </div>

        <!-- PDF Content Area -->
        <div id="pdf-content" class="pdf-content" *ngIf="inventoryData">
          <!-- Header -->
          <div class="pdf-header text-center mb-4">
            <h2 class="mb-1">NHAI RAMS</h2>
            <h4 class="mb-3">Road Inventory Report</h4>
            <p class="text-muted">
              Generated on: {{ inventoryData.created_on | date : "medium" }}
            </p>
          </div>

          <!-- Road Information -->
          <div class="pdf-section mb-4">
            <h5 class="section-title bg-primary text-white p-2">
              <i class="ri-road-map-line me-2"></i>Road Information
            </h5>
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <td class="fw-semibold" width="30%">Road Name</td>
                  <td>{{ inventoryData.road_name || "-" }}</td>
                </tr>
                <tr>
                  <td class="fw-semibold">Chainage Range</td>
                  <td>
                    {{ inventoryData.chainage_start }} -
                    {{ inventoryData.chainage_end }} KM
                  </td>
                </tr>
                <tr>
                  <td class="fw-semibold">Direction</td>
                  <td>{{ inventoryData.direction || "-" }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Asset Information -->
          <div class="pdf-section mb-4">
            <h5 class="section-title bg-success text-white p-2">
              <i class="ri-building-line me-2"></i>Asset Information
            </h5>
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <td class="fw-semibold" width="30%">Asset Action</td>
                  <td>
                    <span
                      [class]="
                        inventoryData.asset_action === 'add'
                          ? 'badge bg-success'
                          : 'badge bg-warning'
                      "
                    >
                      {{
                        inventoryData.asset_action === "add"
                          ? "Add Asset"
                          : "Report Missing"
                      }}
                    </span>
                  </td>
                </tr>
                <tr>
                  <td class="fw-semibold">Asset Type</td>
                  <td>{{ inventoryData.asset_type || "-" }}</td>
                </tr>
                <tr>
                  <td class="fw-semibold">Sub Asset Type</td>
                  <td>{{ inventoryData.sub_asset_type || "N/A" }}</td>
                </tr>
                <tr>
                  <td class="fw-semibold">Quantity</td>
                  <td>{{ inventoryData.numbers_inventory || 0 }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Location Information -->
          <div class="pdf-section mb-4">
            <h5 class="section-title bg-warning text-white p-2">
              <i class="ri-map-pin-line me-2"></i>Location Information
            </h5>
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <td class="fw-semibold" width="30%">Latitude</td>
                  <td>{{ inventoryData.latitude || "-" }}</td>
                </tr>
                <tr>
                  <td class="fw-semibold">Longitude</td>
                  <td>{{ inventoryData.longitude || "-" }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Media Information -->
          <div
            class="pdf-section mb-4"
            *ngIf="
              inventoryData.inventory_image || inventoryData.inventory_video
            "
          >
            <h5 class="section-title bg-info text-white p-2">
              <i class="ri-image-line me-2"></i>Media Files
            </h5>
            <table class="table table-bordered">
              <tbody>
                <tr *ngIf="inventoryData.inventory_image">
                  <td class="fw-semibold" width="30%">Image File</td>
                  <td>{{ inventoryData.inventory_image }}</td>
                </tr>
                <tr *ngIf="inventoryData.inventory_video">
                  <td class="fw-semibold">Video File</td>
                  <td>{{ inventoryData.inventory_video }}</td>
                </tr>
              </tbody>
            </table>
          </div>

          <!-- Footer -->
          <div class="pdf-footer text-center mt-5 pt-4 border-top">
            <p class="text-muted mb-0">
              <small
                >This is a computer-generated document. No signature is
                required.</small
              >
            </p>
            <p class="text-muted mb-0">
              <small>Â© 2025 NHAI RAMS - Road Asset Management System</small>
            </p>
          </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="!inventoryData" class="text-center py-5">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <p class="mt-3 text-muted">Loading inventory details...</p>
        </div>
      </div>
    </div>
  </div>
</div>
